# Supported filenames: docker-compose.yml, docker-compose.yaml, fig.yml, fig.yaml
# RUN: docker-compose build && docker-compose up -d
data:
  # pure data container
  image: busybox
  volumes:
    - /etc/postgresql
    - /var/log/postgresql:/var/log/postgresql
    - /var/lib/postgresql:/var/lib/postgresql #TODO mount host to the postgresql database path
    - /var/log/nginx:/var/log/nginx
    - /var/log/supervisor:/var/log/supervisor
    - /git-repos/myweb:/git-repos/myweb # source code for web container

db:
  image: postgres
  volumes_from:
    - data
  environment:
    - POSTGRES_PASSWORD=pass
#  ports:
#    # "HOST:CONTAINER"
#    - "5432:5432" # conflic with local install posgresql, map to another port

web:
  build: .
  ports:
    - "80:80"
    - "443:443"
  links:
    - db
  volumes_from:
    - data